let cauHoi = [{
    'id': 1,
    'question': '“Văn hóa là sự tổng hợp của mọi phương thức sinh hoạt cùng với biểu hiện của nó mà loài người đã sản sinh ra nhằm thích ứng những nhu cầu đời sống và đòi hỏi của sự sinh tồn” là định nghĩa văn hóa của ai?',
    'answer': [{
        'title': 'Cao Xuân Hạo',
        'isRight': false,
    },
    {
        'title': 'Hồ Chí Minh',
        'isRight': true,
    },
    {
        'title': 'UNESCO',
        'isRight': false,
    },
    {
        'title': 'Phan Ngọc',
        'isRight': false,
    },
    ],
    'isMultiAnswer': false,
},
{
    'id': 2,
    'question': '"Phương Đông"(văn hóa ) là khu vực bao gồm những châu lục nào?',
    'answer': [{
        'title': 'Châu Á, Châu Âu, Châu Úc',
        'isRight': false,
    },
    {
        'title': 'Châu Á , Châu Âu, Châu Phi',
        'isRight': false,
    },
    {
        'title': 'Châu Á ,Châu Phi,Châu Úc',
        'isRight': true,
    },
    {
        'title': 'Châu Âu, Châu Á, Châu Mỹ',
        'isRight': false,
    },
    ],
    'isMultiAnswer': false,
},
{
    'id': 3,
    'question': `Cư dân Đông Nam Á coi trọng thiên nhiên vì thiên nhiên có tác động trực tiếp đến:`,
    'answer': [{
        'title': 'Sức khỏe, thức ăn',
        'isRight': false,
    },
   
    {
        'title': 'Nghề nghiệp, sức khỏe, nơi ở của họ',
        'isRight': true,
    },
    {
        'title': 'Địa lý',
        'isRight': false,
    },
    {
        'title': 'Tính cách của họ.',
        'isRight': false,
    },
    ],
    'isMultiAnswer': false,
},
{
    'id': 4,
    'question': `Trong sự giao lưu rộng rãi với các nền văn hóa Đông Tây, văn hóa Việt Nam chịu ảnh hưởng sâu đậm của nền văn hóa nào?`,
    'answer': [{
        'title': 'Ấn Độ',
        'isRight': false,
    },
    {
        'title': 'Mỹ',
        'isRight': false,
    },
    {
        'title': 'Pháp',
        'isRight': false,
    },
    {
        'title': 'Trung Hoa',
        'isRight': true,
    },
    ],
    'isMultiAnswer': false,
},
{
    'id': 5,
    'question': `Cách tư duy của người Việt truyền thống thiên về:`,
    'answer': [{
        'title': 'Phân tích và trọng yếu tố; chủ quan, cảm tính, kinh nghiệm.',
        'isRight': false,
    },
    {
        'title': 'Tổng hợp và trọng quan hệ; chủ quan, cảm tính, kinh nghiệm. ',
        'isRight': true,
    },
    {
        'title': 'Tổng hợp và trọng yếu tố; chủ quan, lý tính, kinh nghiệm.',
        'isRight': false,
    },
    {
        'title': 'Tổng hợp và trọng quan hệ; khách quan, cảm tính, kinh nghiệm. ',
        'isRight': false,
    },
    ],
    'isMultiAnswer': false,
},
{
    'id': 6,
    'question': `Làng Đông Sơn – chiếc nôi của nền văn minh Đông Sơn trong lịch sử thuộc khu vực văn hóa nào sau đây?`,
    'answer': [{
        'title': 'Tây Bắc  ',
        'isRight': false,
    },
    {
        'title': 'Việt Bắc',
        'isRight': false,
    },
    {
        'title': 'Bắc Bộ ',
        'isRight': true,
    },
    {
        'title': 'Đông Bắc',
        'isRight': false,
    },
    ],
    'isMultiAnswer': false,
},
{
    'id': 7,
    'question': `Thời kỳ 938-1858 ứng với giai đoạn nào trong tiến trình lịch sử của văn hóa Việt Nam?`,
    'answer': [{
        'title': 'Giai đoạn văn hóa Đại Việt',
        'isRight': true,
    },
    {
        'title': 'Giai đọan văn hoá tiền sử',
        'isRight': false,
    },
    {
        'title': 'Giai đoạn văn hóa Văn Lang- Âu Lạc',
        'isRight': false,
    },
    {
        'title': 'Giai đoạn văn hóa thời kỳ Bắc thuộc',
        'isRight': false,
    },
    ],
    'isMultiAnswer': false,
},
{
    'id': 8,
    'question': `Thời kỳ văn hóa Văn Lang-Âu Lạc có ba trung tâm văn hóa lớn là:`,
    'answer': [{
        'title': 'Văn hóa Đông Sơn – Văn hóa Sa Huỳnh – Văn hóa Đồng Nai',
        'isRight': true,
    },
    {
        'title': 'Văn hóa Đông Sơn – Văn hóa Sa Huỳnh – Văn hóa Óc Eo',
        'isRight': false,
    },
    {
        'title': 'Văn hóa Hòa Bình – Văn hóa Sơn Vi – Văn hóa Phùng Nguyên',
        'isRight': false,
    },
    {
        'title': 'Văn hóa châu thổ Bắc Bộ – Văn hóa Chămpa – Văn hóa Óc Eo',
        'isRight': false,
    },
    ],
    'isMultiAnswer': false,
},
{
    'id': 9,
    'question': `Biểu tượng âm dương truyền thống lâu đời của người Việt là:`,
    'answer': [{
        'title': 'Công cha nghĩa mẹ',
        'isRight': false,
    },
    {
        'title': 'Con Rồng Cháu Tiên',
        'isRight': false,
    },
    {
        'title': 'Biểu tượng vuông tròn',
        'isRight': true,
    },
    {
        'title': 'Ông Tơ bà Nguyệt',
        'isRight': false,
    },
    ],
    'isMultiAnswer': false,
},
{
    'id': 10,
    'question': `Trong Ngũ hành, hành nào được đặt vào vị trí trung tâm, cai quản bốn phương?`,
    'answer': [{
        'title': 'Hành Thổ',
        'isRight': true,
    },
    {
        'title': 'Hành Mộc',
        'isRight': false,
    },
    {
        'title': 'Hành Thủy',
        'isRight': false,
    },
    {
        'title': 'Hành Kim',
        'isRight': false,
    },
    ],
    'isMultiAnswer': false,
},
];

let rightAnswerMessages = [
    `Yeahhh! Chính xác <i class="far fa-2x fa-laugh-squint"></i>`,
    `Wow,bạn ghê đấy <i class="far fa-2x fa-grin-stars"></i>`,
    `Bạn đã trả lời đúng! <i class="far fa-2x fa-kiss"></i>`,
    `Đúng Rồi, tiếp nào... <i class="far fa-2x fa-grin-alt"></i>`,
]

let wrongAnswerMessages = [
    `Hả? Sai rồi. <i class="far fa-2x fa-flushed"></i>`,
    `Sai rồi nha bạn. Cố lên <i class="far fa-2x fa-grin-beam-sweat"></i>`,
    `Bạn đã trả lời sai! <i class="far fa-2x fa-meh"></i>`,
    `Có gì đó không đúng? <i class="far fa-2x fa-meh-rolling-eyes"></i>`,
]

let suffleCauHoi;

let userResult = 0;

let currentQuestion;
let indexQuestion = 0;
let totalQuestion = 0;

newGame();

function submitAnswer() {
    if (checkHasAnswer()) {
        let nameAnswer = "answer_" + currentQuestion.id;
        let right = true;
        for (let i = 0; i < document.getElementsByName(nameAnswer).length; i++) {
            let answer = document.getElementsByName(nameAnswer)[i];
            if (answer.value.toLowerCase() === 'true' && !answer.checked) {
                right = false;
                break;
            }
        }
        if (right) {
            rightAnswer();
        } else {
            wrongAnswer();
        }
        preParaForNextQuestion();
    } else {
        needAnswerQuestion();
    }
}

function checkHasAnswer() {
    let hasAnswer = false;
    let nameAnswer = "answer_" + currentQuestion.id;
    for (let i = 0; i < document.getElementsByName(nameAnswer).length; i++) {
        let answer = document.getElementsByName(nameAnswer)[i];
        if (answer.checked) {
            hasAnswer = true;
            break;
        }
    }
    return hasAnswer;
}

function nextQuestion() {
    currentQuestion = suffleCauHoi.shift();
    if (currentQuestion) {
        indexQuestion++;
        newQuestion();
        hideResult();
        displayQuestion(currentQuestion, indexQuestion);
    } else {
        finished();
    }
}

function preParaForNextQuestion() {
    document.getElementById('btnSubmitAnswer').style.display = 'none';
    document.getElementById('btnNextQuestion').style.display = 'block';
}

function displayQuestion(cQuestion, indexQuestion) {
    document.getElementById("indexQuestion").innerHTML = indexQuestion;
    document.getElementById("totalQuestion").innerHTML = totalQuestion;
    document.getElementById("contentQuestion").innerHTML = standardContentQuestion(cQuestion.question);
    document.getElementById("answerQuestion").innerHTML = "";
    let tblAnswert = '';
    if(cQuestion.isMultiAnswer){
        for (let i = 0; i < cQuestion.answer.length; i++) {
            const answer = cQuestion.answer[i];
            tblAnswert += `<li>
                            <input class="hidden" type="checkbox" value="${answer.isRight}" id="answer_${indexQuestion}_${i + 1}" name="answer_${cQuestion.id}"/>
                            <label class="w-100p m-0 py-1" for="answer_${indexQuestion}_${i + 1}">
                                ${standardContentQuestion(answer.title)}
                            </label>
                        </li>`;
        }
    }else{
        for (let i = 0; i < cQuestion.answer.length; i++) {
            const answer = cQuestion.answer[i];
            tblAnswert += `<li>
                            <input class="hidden" type="radio" value="${answer.isRight}" id="answer_${indexQuestion}_${i + 1}" name="answer_${cQuestion.id}"/>
                            <label class="w-100p m-0 py-1" for="answer_${indexQuestion}_${i + 1}">
                                ${standardContentQuestion(answer.title)}
                            </label>
                        </li>`;
        }
    }
    document.getElementById("answerQuestion").innerHTML = tblAnswert;
}

function standardContentQuestion(content){
    return content.replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');
}

function onToggleSelected(e){
    console.dir(e.target.parentElement);
    e.target.parentElement.classList.toggle('selected');
}

function hideResult() {
    document.getElementById("rightAnswer").style.display = 'none';
    document.getElementById("wrongAnswer").style.display = 'none';
    document.getElementById("needAnswer").style.display = 'none';
}

function newQuestion() {
    document.getElementById('btnSubmitAnswer').style.display = 'block';
    document.getElementById("btnNextQuestion").style.display = "none";
}

function rightAnswer() {
    hideResult();
    document.getElementById("rightAnswer").style.display = 'block';
    document.getElementById("rightAnswer").innerHTML = getRandomMessage(rightAnswerMessages);
    userResult++;
}

function getRandomMessage(listMessages){
    let ran = Math.floor(Math.random() * listMessages.length);
    return listMessages[ran];
}



function wrongAnswer() {
    hideResult();
    document.getElementById("wrongAnswer").style.display = 'block';
    document.getElementById("wrongAnswer").innerHTML = getRandomMessage(wrongAnswerMessages);
}

function needAnswerQuestion() {
    hideResult();
    document.getElementById("needAnswer").style.display = 'block';
}

function finished() {
    document.getElementById("playing").style.display = 'none';
    document.getElementById("result").style.display = 'block';
    document.getElementById("userResult").innerHTML =
        "Bạn trả lời đúng " + userResult + " trên " + totalQuestion + " câu hỏi";
}

function newGame() {
    document.getElementById("playing").style.display = 'block';
    document.getElementById("result").style.display = 'none';
    suffleCauHoi = suffleCauHoiF();
    indexQuestion = 0;
    userResult = 0;
    totalQuestion = suffleCauHoi.length;
    nextQuestion();
}

function suffleCauHoiF() {
    let copy = JSON.parse(JSON.stringify(cauHoi));
    let result = [];
    while(copy.length > 0){
        let i = Math.floor(Math.random() * copy.length);
        result.push(copy.splice(i, 1)[0]);
    }
    return result;
}